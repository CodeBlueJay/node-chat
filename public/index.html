<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Chat</title>
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: 'Arial', sans-serif;
        }

        .stars {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
    }

    .star {
        position: absolute;
        background: white;
        width: 2px;
        height: 2px;
        border-radius: 50%;
        animation: twinkle 2.5s infinite;
    }

    @keyframes twinkle {
        0% { opacity: 0; transform: translateY(-200px); }
        10% { opacity: 1; transform: translateY(0px); }
        90% { opacity: 1; }
        100% { opacity: 0; transform: translateY(200px); }
    }

.star:nth-child(1) { top: 92%; left: 45%; animation-delay: 0.0s; }
.star:nth-child(2) { top: 99%; left: 34%; animation-delay: 0.8s; }
.star:nth-child(3) { top: 12%; left: 94%; animation-delay: 0.6s; }
.star:nth-child(4) { top: 68%; left: 78%; animation-delay: 1.9s; }
.star:nth-child(5) { top: 2%; left: 84%; animation-delay: 0.7s; }
.star:nth-child(6) { top: 79%; left: 54%; animation-delay: 0.7s; }
.star:nth-child(7) { top: 23%; left: 69%; animation-delay: 0.1s; }
.star:nth-child(8) { top: 58%; left: 19%; animation-delay: 0.3s; }
.star:nth-child(9) { top: 16%; left: 44%; animation-delay: 1.7s; }
.star:nth-child(10) { top: 3%; left: 93%; animation-delay: 1.2s; }
.star:nth-child(11) { top: 6%; left: 35%; animation-delay: 1.7s; }
.star:nth-child(12) { top: 7%; left: 6%; animation-delay: 1.5s; }
.star:nth-child(13) { top: 59%; left: 99%; animation-delay: 1.4s; }
.star:nth-child(14) { top: 31%; left: 37%; animation-delay: 0.8s; }
.star:nth-child(15) { top: 5%; left: 98%; animation-delay: 0.7s; }
.star:nth-child(16) { top: 71%; left: 78%; animation-delay: 1.7s; }
.star:nth-child(17) { top: 4%; left: 37%; animation-delay: 0.8s; }
.star:nth-child(18) { top: 93%; left: 63%; animation-delay: 1.6s; }
.star:nth-child(19) { top: 63%; left: 90%; animation-delay: 0.7s; }
.star:nth-child(20) { top: 71%; left: 15%; animation-delay: 0.5s; }
.star:nth-child(21) { top: 27%; left: 25%; animation-delay: 0.6s; }
.star:nth-child(22) { top: 4%; left: 54%; animation-delay: 1.1s; }
.star:nth-child(23) { top: 14%; left: 10%; animation-delay: 0.6s; }
.star:nth-child(24) { top: 17%; left: 69%; animation-delay: 1.7s; }
.star:nth-child(25) { top: 43%; left: 48%; animation-delay: 1.3s; }
.star:nth-child(26) { top: 42%; left: 36%; animation-delay: 0.1s; }
.star:nth-child(27) { top: 20%; left: 100%; animation-delay: 1.0s; }
.star:nth-child(28) { top: 83%; left: 13%; animation-delay: 1.5s; }
.star:nth-child(29) { top: 100%; left: 12%; animation-delay: 1.3s; }
.star:nth-child(30) { top: 90%; left: 78%; animation-delay: 1.0s; }
.star:nth-child(31) { top: 62%; left: 24%; animation-delay: 1.4s; }
.star:nth-child(32) { top: 54%; left: 27%; animation-delay: 1.4s; }
.star:nth-child(33) { top: 54%; left: 35%; animation-delay: 0.2s; }
.star:nth-child(34) { top: 70%; left: 6%; animation-delay: 0.4s; }
.star:nth-child(35) { top: 61%; left: 4%; animation-delay: 1.7s; }
.star:nth-child(36) { top: 70%; left: 50%; animation-delay: 0.5s; }
.star:nth-child(37) { top: 11%; left: 18%; animation-delay: 0.9s; }
.star:nth-child(38) { top: 3%; left: 71%; animation-delay: 1.9s; }
.star:nth-child(39) { top: 41%; left: 56%; animation-delay: 1.6s; }
.star:nth-child(40) { top: 28%; left: 98%; animation-delay: 0.4s; }
.star:nth-child(41) { top: 88%; left: 31%; animation-delay: 1.3s; }
.star:nth-child(42) { top: 98%; left: 68%; animation-delay: 0.2s; }
.star:nth-child(43) { top: 72%; left: 69%; animation-delay: 1.1s; }
.star:nth-child(44) { top: 97%; left: 79%; animation-delay: 1.4s; }
.star:nth-child(45) { top: 9%; left: 91%; animation-delay: 1.5s; }
.star:nth-child(46) { top: 75%; left: 75%; animation-delay: 0.7s; }
.star:nth-child(47) { top: 6%; left: 43%; animation-delay: 0.3s; }
.star:nth-child(48) { top: 9%; left: 71%; animation-delay: 1.5s; }
.star:nth-child(49) { top: 72%; left: 90%; animation-delay: 0.4s; }
.star:nth-child(50) { top: 90%; left: 42%; animation-delay: 1.4s; }
.star:nth-child(51) { top: 1%; left: 25%; animation-delay: 1.3s; }
.star:nth-child(52) { top: 97%; left: 49%; animation-delay: 0.6s; }
.star:nth-child(53) { top: 72%; left: 22%; animation-delay: 0.2s; }
.star:nth-child(54) { top: 52%; left: 20%; animation-delay: 1.9s; }
.star:nth-child(55) { top: 8%; left: 19%; animation-delay: 1.7s; }
.star:nth-child(56) { top: 67%; left: 30%; animation-delay: 1.2s; }
.star:nth-child(57) { top: 39%; left: 100%; animation-delay: 0.0s; }
.star:nth-child(58) { top: 19%; left: 72%; animation-delay: 1.1s; }
.star:nth-child(59) { top: 78%; left: 93%; animation-delay: 0.9s; }
.star:nth-child(60) { top: 48%; left: 23%; animation-delay: 0.2s; }
.star:nth-child(61) { top: 53%; left: 34%; animation-delay: 1.1s; }
.star:nth-child(62) { top: 69%; left: 58%; animation-delay: 0.8s; }
.star:nth-child(63) { top: 62%; left: 99%; animation-delay: 1.6s; }
.star:nth-child(64) { top: 65%; left: 10%; animation-delay: 1.5s; }
.star:nth-child(65) { top: 7%; left: 18%; animation-delay: 0.0s; }
.star:nth-child(66) { top: 82%; left: 100%; animation-delay: 0.8s; }
.star:nth-child(67) { top: 9%; left: 68%; animation-delay: 0.9s; }
.star:nth-child(68) { top: 75%; left: 91%; animation-delay: 1.4s; }
.star:nth-child(69) { top: 15%; left: 57%; animation-delay: 1.7s; }
.star:nth-child(70) { top: 76%; left: 19%; animation-delay: 1.8s; }
.star:nth-child(71) { top: 13%; left: 11%; animation-delay: 0.0s; }
.star:nth-child(72) { top: 76%; left: 47%; animation-delay: 1.7s; }
.star:nth-child(73) { top: 14%; left: 91%; animation-delay: 1.1s; }
.star:nth-child(74) { top: 66%; left: 17%; animation-delay: 0.5s; }
.star:nth-child(75) { top: 20%; left: 81%; animation-delay: 1.3s; }
.star:nth-child(76) { top: 11%; left: 34%; animation-delay: 1.7s; }
.star:nth-child(77) { top: 64%; left: 76%; animation-delay: 0.8s; }
.star:nth-child(78) { top: 29%; left: 94%; animation-delay: 0.4s; }
.star:nth-child(79) { top: 36%; left: 58%; animation-delay: 1.9s; }
.star:nth-child(80) { top: 60%; left: 93%; animation-delay: 0.7s; }
.star:nth-child(81) { top: 81%; left: 93%; animation-delay: 0.5s; }
.star:nth-child(82) { top: 8%; left: 66%; animation-delay: 1.7s; }
.star:nth-child(83) { top: 59%; left: 76%; animation-delay: 1.7s; }
.star:nth-child(84) { top: 85%; left: 73%; animation-delay: 0.8s; }
.star:nth-child(85) { top: 6%; left: 79%; animation-delay: 0.7s; }
.star:nth-child(86) { top: 62%; left: 92%; animation-delay: 0.8s; }
.star:nth-child(87) { top: 37%; left: 74%; animation-delay: 1.0s; }
.star:nth-child(88) { top: 83%; left: 65%; animation-delay: 0.0s; }
.star:nth-child(89) { top: 28%; left: 4%; animation-delay: 1.8s; }
.star:nth-child(90) { top: 47%; left: 59%; animation-delay: 0.6s; }
.star:nth-child(91) { top: 78%; left: 22%; animation-delay: 1.0s; }
.star:nth-child(92) { top: 3%; left: 95%; animation-delay: 1.3s; }
.star:nth-child(93) { top: 49%; left: 19%; animation-delay: 1.8s; }
.star:nth-child(94) { top: 88%; left: 4%; animation-delay: 1.2s; }
.star:nth-child(95) { top: 65%; left: 93%; animation-delay: 0.7s; }
.star:nth-child(96) { top: 95%; left: 98%; animation-delay: 0.8s; }
.star:nth-child(97) { top: 64%; left: 4%; animation-delay: 0.3s; }
.star:nth-child(98) { top: 43%; left: 13%; animation-delay: 1.8s; }
.star:nth-child(99) { top: 88%; left: 47%; animation-delay: 0.5s; }
.star:nth-child(100) { top: 54%; left: 58%; animation-delay: 1.3s; }
    /* Add more stars as needed */

        /* Smooth transition for showing/hiding elements */
        .fade-in {
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }

        .fade-out {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        #nameForm, #settingsMenu {
            margin: 50px auto;
            width: 300px;
            text-align: center;
            transform: scale(1);
            transition: transform 0.5s ease-in-out;
        }

        #nameInputForm, #settingsForm {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        input[type="text"], button {
            margin-top: 10px;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #222;
            color: #fff;
            font-size: 16px;
            outline: none;
            cursor: pointer;
            transition-duration: 0.4s;
        }

        button:hover {
            background-color: #333;
        }

        #chatBox {
            display: none;
            margin: 50px auto;
            width: 600px;
            text-align: center;
            transform: scale(0.1);
            transition: transform 0.5s ease-in-out;
        }

        #messages {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            background-color: #222;
            border-radius: 10px;
        }

        .message {
            margin: 30px 0;
            padding: 5px;
            border-radius: 5px;
            word-wrap: break-word;
            position: relative;
        }


        .message p {
            margin: 0;
            padding: 0;
        }

        .message .sender {
            font-size: 12px;
            color: #aaa;
            position: absolute;
            top: -15px;
            left: 0;
        }

        .message .timestamp {
            font-size: 12px;
            color: #aaa;
            position: absolute;
            bottom: -15px;
            left: 0;
        }

        .sent {
            background-color: #0af;
            color: #fff;
            margin-left: auto;
        }

        .received {
            background-color: #333;
            color: #fff;
            margin-right: auto;
        }

        #input {
            width: calc(100% - 60px);
        }

        #form {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #form input[type="text"], #form button {
            margin: 0;
        }

        #settingsMenu {
            display: none;
        }

        h2 {
            margin-bottom: 20px;
        }

        #newNameInput {
            width: 100%;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="nameForm">
        <form id="nameInputForm">
            <input id="nameInput" type="text" placeholder="Enter your name"/>
            <button type="submit" onclick="zoomOut()">Join Chat</button>
        </form>
    </div>
    
    <div id="chatBox">
        <div id="messages"></div>
        <form id="form" action="">
            <input id="input" autocomplete="off" placeholder="Type your message..." /><button>Send</button>
        </form>
    </div>

    <div id="settingsMenu">
        <h2>Settings</h2>
        <form id="settingsForm">
            <input id="newNameInput" type="text" placeholder="Change Name" autocomplete="off" />
            <button type="submit">Save</button>
        </form>
    </div>

    <div class="stars">
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
        <div class="star"></div>
    </div>


    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();
        var senderName = localStorage.getItem('chatUserName') || ""; 

        function zoomOut() {
            setTimeout(() => {
                document.getElementById('nameForm').style.transform = 'scale(5)';
            }, 0); // Delay the transition slightly to ensure smoother animation
        }

        function showChat() {
            document.getElementById('nameForm').style.transform = 'scale(500)';
            setTimeout(() => {
                document.getElementById('nameForm').style.display = 'none';
                document.getElementById('chatBox').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('chatBox').style.transform = 'scale(1)';
                }, 10); // Delay the transition slightly to ensure smoother animation
            }, 500); // Change according to your animation duration
        }

        function showSettings() {
            document.getElementById('chatBox').style.display = 'none';
            document.getElementById('settingsMenu').style.display = 'block';
            document.getElementById('newNameInput').value = senderName;
        }

        document.getElementById('nameInputForm').addEventListener('submit', function(e) {
            e.preventDefault();
            var nameInput = document.getElementById('nameInput');
            if (nameInput.value.trim() !== '') {
                senderName = nameInput.value.trim();
                localStorage.setItem('chatUserName', senderName);
                showChat();
            }
        });

        document.getElementById('settingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            var newNameInput = document.getElementById('newNameInput');
            if (newNameInput.value.trim() !== '') {
                senderName = newNameInput.value.trim();
                localStorage.setItem('chatUserName', senderName);
                showChat();
            }
        });

        socket.on('chat message', function(data) {
            var messagesDiv = document.getElementById('messages');
            if (data && data.sender && data.message && data.timestamp) {
                var messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(data.sender === senderName ? 'sent' : 'received');
                var senderParagraph = document.createElement('p');
                senderParagraph.classList.add('sender');
                senderParagraph.textContent = data.sender;
                var messageParagraph = document.createElement('p');
                messageParagraph.textContent = data.message;
                var timestampParagraph = document.createElement('p');
                timestampParagraph.classList.add('timestamp');
                timestampParagraph.textContent = new Date(data.timestamp).toLocaleString();
                messageDiv.appendChild(senderParagraph);
                messageDiv.appendChild(messageParagraph);
                messageDiv.appendChild(timestampParagraph);
             messagesDiv.appendChild(messageDiv);

                // Scroll to the bottom of the messages
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }
        });


        document.getElementById('form').addEventListener('submit', function(e) {
            e.preventDefault();
            var input = document.getElementById('input');
            if (input.value && senderName !== "") {
                var timestamp = Date.now();
                socket.emit('chat message', { sender: senderName, message: input.value, timestamp: timestamp });
                input.value = '';
            }
        });
    </script>
</body>
</html>
